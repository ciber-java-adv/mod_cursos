<beans:beans xmlns="http://www.springframework.org/schema/security"
  xmlns:beans="http://www.springframework.org/schema/beans"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
           http://www.springframework.org/schema/security
           http://www.springframework.org/schema/security/spring-security-3.1.xsd">
 
        <global-method-security pre-post-annotations="enabled"/>
        
	<http  use-expressions="true">
                <intercept-url pattern="/login.jsf" access="permitAll"/>
                              
		<intercept-url pattern="/curso/*" access="hasAnyRole('usuarios','administradores')" />
                
                <form-login 
                    login-page="/login.jsf" 
                    default-target-url="/index.jsf"
                    
			/>
		<logout logout-success-url="/login.jsf" />    
               
                <session-management invalid-session-url="/login.jsf" />  
                
	</http>
 
	<authentication-manager alias="authenticationManager">
           <!--
	  <authentication-provider>
	    <user-service>
		<user name="lbenvenutoc" password="123456" authorities="ROLE_USER" />
                
	    </user-service>
	  </authentication-provider>
          
         
          
          
          
          <authentication-provider>
		<jdbc-user-service data-source-ref="dataSource"
 
		   users-by-username-query="
		      select username, password, enabled 
		      from user where username = ? " 
 
		   authorities-by-username-query="
		      select u.username, r.name from user u, user_role ur, role r
		      where u.user_id = ur.user_id and r.role_id = ur.role_id and u.username = ?  " 
 
		/>
	   </authentication-provider>
           
           <authentication-provider ref="myAuthenticationProvider"/>
           
           -->
           <authentication-provider ref="myAuthenticationProvider"/>
            
	</authentication-manager>
        
</beans:beans>